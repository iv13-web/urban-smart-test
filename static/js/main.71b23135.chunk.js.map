{"version":3,"sources":["components/PrivateRoute.js","store/authSlice.js","pages/Home.js","hooks/useUpdatedEffect.js","pages/Profile.js","store/initSlice.js","App.js","reportWebVitals.js","utils/storage.js","store/middlewares/localStorage.js","store/store.js","index.js"],"names":["PrivateRoute","Component","component","rest","isSignedIn","useSelector","state","auth","render","props","to","CORRECT_CREDENTIALS","initialState","currentUser","enteredCredentialsValidity","authSlice","createSlice","name","reducers","initAuth","payload","checkCredentialsValidity","login","password","correctLogin","correctPassword","signin","signout","authReducer","reducer","actions","useStyles","makeStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","form","width","submit","margin","Home","s","history","useHistory","useState","credentials","setCredentials","dispatch","useDispatch","validCredentials","callback","dependencies","firstRenderRef","useRef","useEffect","current","useUpdatedEffect","handleInputChange","target","prevState","value","Container","maxWidth","className","noValidate","onSubmit","replace","TextField","autoFocus","variant","required","fullWidth","label","onChange","Button","type","color","disabled","wrapper","justifyContent","Profile","onClick","initSlice","init","initReducer","App","basename","exact","path","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","storage","key","JSON","parse","localStorage","getItem","e","data","setItem","stringify","localStorageMiddleware","store","next","action","match","storedAuthStatus","storedCurrentUser","getState","configureStore","middleware","getDefaultMiddleware","concat","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.71b23135.chunk.js","sourcesContent":["import {useSelector} from 'react-redux'\r\nimport {Route, Redirect} from 'react-router-dom'\r\n\r\nexport default function PrivateRoute({component: Component, ...rest}) {\r\n  const isSignedIn = useSelector(state => state.auth.isSignedIn)\r\n\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={props => (\r\n        isSignedIn\r\n          ? <Component {...props} />\r\n          : <Redirect to='/'/>\r\n      )}\r\n    />\r\n  )\r\n}\r\n","import {createSlice} from '@reduxjs/toolkit'\r\n\r\nconst CORRECT_CREDENTIALS = {\r\n\tlogin: 'developer21',\r\n\tpassword: '123456'\r\n}\r\n\r\nconst initialState = {\r\n\tisSignedIn: false,\r\n\tcurrentUser: null,\r\n\tenteredCredentialsValidity: false\r\n}\r\n\r\nconst authSlice = createSlice({\r\n\tname: 'auth',\r\n\tinitialState,\r\n\treducers: {\r\n\t\tinitAuth: (state, {payload}) => {\r\n\t\t\tstate.isSignedIn = payload.isSignedIn || false\r\n\t\t\tstate.currentUser = payload.currentUser || null\r\n\t\t},\r\n\t\tcheckCredentialsValidity: (state, {payload}) => {\r\n\t\t\tconst {login, password} = payload\r\n\t\t\tconst correctLogin = login === CORRECT_CREDENTIALS.login\r\n\t\t\tconst correctPassword = password === CORRECT_CREDENTIALS.password\r\n\t\t\tstate.enteredCredentialsValidity = correctLogin && correctPassword\r\n\t\t},\r\n\t\tsignin: (state, {payload}) => {\r\n\t\t\tif (state.enteredCredentialsValidity) {\r\n\t\t\t\tstate.isSignedIn = true\r\n\t\t\t\tstate.currentUser = payload\r\n\t\t\t}\r\n\t\t},\r\n\t\tsignout: () => {\r\n\t\t\treturn initialState\r\n\t\t}\r\n\t}\r\n})\r\n\r\nexport const authReducer =  authSlice.reducer\r\nexport const {initAuth, checkCredentialsValidity, signin, signout} = authSlice.actions\r\n","import {Button, Container, makeStyles, TextField} from '@material-ui/core'\r\nimport {checkCredentialsValidity, signin} from '../store/authSlice'\r\nimport {useDispatch, useSelector} from 'react-redux'\r\nimport useUpdatedEffect from '../hooks/useUpdatedEffect'\r\nimport {useHistory} from 'react-router-dom'\r\nimport {useState} from 'react'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  form: {\r\n    width: '100%',\r\n    marginTop: theme.spacing(1),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  }\r\n}))\r\n\r\nexport default function Home() {\r\n  const s = useStyles()\r\n  const history = useHistory()\r\n  const [credentials, setCredentials] = useState({\r\n    login: '',\r\n    password: ''\r\n  })\r\n  const {login, password} = credentials\r\n  const dispatch = useDispatch()\r\n  const validCredentials = useSelector(state => {\r\n    return state.auth.enteredCredentialsValidity\r\n  })\r\n\r\n  useUpdatedEffect(() => {\r\n    dispatch(checkCredentialsValidity({login, password}))\r\n  }, [login, password])\r\n\r\n  const handleInputChange = ({target}) => {\r\n    return setCredentials(prevState => ({\r\n      ...prevState,\r\n      [target.name]: target.value\r\n    }))\r\n  }\r\n\r\n  const handleSubmit = () => {\r\n    dispatch(signin(login))\r\n    history.replace('/profile')\r\n  }\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <div className={s.paper}>\r\n        <form className={s.form} noValidate onSubmit={handleSubmit}>\r\n          <TextField\r\n            autoFocus\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            name='login'\r\n            label=\"Логин\"\r\n            value={login}\r\n            onChange={handleInputChange}\r\n          />\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            name='password'\r\n            label=\"Пароль\"\r\n            value={password}\r\n            onChange={handleInputChange}\r\n          />\r\n          <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            className={s.submit}\r\n            disabled={!validCredentials}\r\n          >\r\n            войти\r\n          </Button>\r\n        </form>\r\n      </div>\r\n    </Container>\r\n  )\r\n}\r\n","import {useEffect, useRef} from \"react\"\r\n\r\nexport default function useUpdatedEffect(callback, dependencies) {\r\n\tconst firstRenderRef = useRef(true)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (firstRenderRef.current) {\r\n\t\t\tfirstRenderRef.current = false\r\n\t\t\treturn\r\n\t\t}\r\n\t\treturn callback()\r\n\t}, dependencies)\r\n}\r\n","import {useDispatch, useSelector} from 'react-redux'\r\nimport {Button, makeStyles} from '@material-ui/core'\r\nimport {signout} from '../store/authSlice'\r\n\r\nconst useStyles = makeStyles({\r\n  wrapper: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  }\r\n})\r\n\r\nexport default function Profile() {\r\n  const s = useStyles()\r\n  const dispatch = useDispatch()\r\n  const currentUser = useSelector(state => state.auth.currentUser)\r\n  const handleSignout = () => {\r\n    dispatch(signout())\r\n  }\r\n\r\n  return (\r\n    <div className={s.wrapper}>\r\n      <h1>{currentUser}</h1>\r\n      <Button\r\n        variant='outlined'\r\n        onClick={handleSignout}\r\n      >\r\n        Выйти\r\n      </Button>\r\n    </div>\r\n  )\r\n}\r\n","import {createSlice} from '@reduxjs/toolkit'\r\n\r\nconst initSlice = createSlice({\r\n\tname: 'init',\r\n\tinitialState: {\r\n\t\tinit: false\r\n\t},\r\n\treducers: {\r\n\t\tinit: (state) => {\r\n\t\t\tstate.init = true\r\n\t\t},\r\n\t}\r\n})\r\n\r\nexport const initReducer = initSlice.reducer\r\nexport const {init} = initSlice.actions\r\n","import {HashRouter, Route, Switch} from 'react-router-dom'\nimport PrivateRoute from './components/PrivateRoute'\nimport Home from './pages/Home'\nimport Profile from './pages/Profile'\nimport {useDispatch} from 'react-redux'\nimport {init} from './store/initSlice'\n\nexport default function App() {\n  const dispatch = useDispatch()\n  dispatch(init())\n\n  return (\n    <HashRouter basename='/'>\n      <Switch>\n        <Route exact path='/' component={Home}/>\n        <PrivateRoute path='/profile' component={Profile}/>\n      </Switch>\n    </HashRouter>\n  )\n}\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","export function storage (key, payload) {\r\n\tif (!payload ?? payload) {\r\n\t\ttry {\r\n\t\t\treturn JSON.parse(localStorage.getItem(key))\r\n\t\t} catch (e) {}\r\n\t}\r\n\tconst {data} = payload\r\n\tlocalStorage.setItem(key, JSON.stringify(data))\r\n}\r\n","import {init} from '../initSlice'\r\nimport {initAuth, signin, signout} from '../authSlice'\r\nimport {storage} from '../../utils/storage'\r\n\r\nexport const localStorageMiddleware = store => next => action => {\r\n\tnext(action)\r\n\r\n\tif (init.match(action)) {\r\n\t\tconst storedAuthStatus = storage('isSignedIn')\r\n\t\tconst storedCurrentUser = storage('currentUser')\r\n\t\tstore.dispatch(initAuth({\r\n\t\t\tisSignedIn: storedAuthStatus,\r\n\t\t\tcurrentUser: storedCurrentUser\r\n\t\t}))\r\n\t}\r\n\tif (signin.match(action) || signout.match(action)) {\r\n\t\tconst isSignedIn = store.getState().auth.isSignedIn\r\n\t\tconst currentUser = store.getState().auth.currentUser\r\n\t\tstorage('isSignedIn', {data: isSignedIn})\r\n\t\tstorage('currentUser', {data: currentUser})\r\n\t}\r\n}\r\n","import {configureStore} from '@reduxjs/toolkit'\r\nimport {authReducer} from './authSlice'\r\nimport {initReducer} from './initSlice'\r\nimport {localStorageMiddleware} from './middlewares/localStorage'\r\n\r\nexport const store = configureStore({\r\n\treducer: {\r\n\t\tinit: initReducer,\r\n\t\tauth: authReducer\r\n\t},\r\n\tmiddleware: (getDefaultMiddleware) => {\r\n\t\treturn getDefaultMiddleware().concat(localStorageMiddleware)\r\n\t}\r\n})","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\nimport {Provider} from 'react-redux'\nimport {store} from './store/store'\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App/>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}